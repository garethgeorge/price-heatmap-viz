(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(14),o=a.n(s),i=(a(73),a(39),a(25)),l=(a(40),a(12)),c=a.n(l),h=a(20),u=a(21),p=a(22),d=a(26),m=a(23),g=a(27),v=(a(85),a(61)),f=a.n(v),y=a(94).getHeatMapData,b=function(e,t,a,n,r,s){return function(o){o<0&&(o=0),o>1&&(o=1);var i=1-o,l=o;return"rgb(".concat(Math.round(i*e+l*n),", ").concat(Math.round(i*t+l*r),", ").concat(Math.round(i*a+l*s),")")}},E=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={loading:!0,data:null,threshold:e.threshold,percentage:e.percentage},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.startDate!==this.state.startDate||this.props.stopDate!==this.state.stopDate){var t=Object.assign({},this.state);t.loading=!0,t.data=null,t.all_values=null,t.startDate=this.props.startDate,t.stopDate=this.props.stopDate,this.setState(t);var a=this.props;Object(h.a)(c.a.mark(function t(){var n,r,s,o,i,l,h,u,p,d,m,g,v,f,b,E;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(a.startDate,a.stopDate);case 2:n=t.sent,(r=Object.assign({},e.state)).loading=!1,r.data=n,s=[],o=n.heatmap,i=!0,l=!1,h=void 0,t.prev=11,u=o[Symbol.iterator]();case 13:if(i=(p=u.next()).done){t.next=37;break}for(d=p.value,m=!0,g=!1,v=void 0,t.prev=18,f=d[Symbol.iterator]();!(m=(b=f.next()).done);m=!0)null!=(E=b.value)&&s.push(E.delta);t.next=26;break;case 22:t.prev=22,t.t0=t.catch(18),g=!0,v=t.t0;case 26:t.prev=26,t.prev=27,m||null==f.return||f.return();case 29:if(t.prev=29,!g){t.next=32;break}throw v;case 32:return t.finish(29);case 33:return t.finish(26);case 34:i=!0,t.next=13;break;case 37:t.next=43;break;case 39:t.prev=39,t.t1=t.catch(11),l=!0,h=t.t1;case 43:t.prev=43,t.prev=44,i||null==u.return||u.return();case 46:if(t.prev=46,!l){t.next=49;break}throw h;case 49:return t.finish(46);case 50:return t.finish(43);case 51:s.sort(),r.all_values=s,e.setState(r);case 54:case"end":return t.stop()}},t,this,[[11,39,43,51],[18,22,26,34],[27,,29,33],[44,,46,50]])}))()}if(this.props.threshold!==this.state.threshold||this.props.percentage!==this.state.percentage){console.log("PERCENTAGE: ",this.props.percentage);var n=Object.assign({},this.state);n.threshold=this.props.threshold,n.percentage=this.props.percentage,this.setState(n),this.forceUpdate()}}},{key:"render",value:function(){var e=this;if(this.state.loading)return r.a.createElement(f.a,{loading:!0,color:"#415EFF"});var t,a=function(e){var t=0,a=!0,n=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){t+=s.value}}catch(m){n=!0,r=m}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}t/=e.length;var i=0,l=!0,c=!1,h=void 0;try{for(var u,p=e[Symbol.iterator]();!(l=(u=p.next()).done);l=!0){var d=u.value;i+=(d-t)*(d-t)}}catch(m){c=!0,h=m}finally{try{l||null==p.return||p.return()}finally{if(c)throw h}}return i/=e.length-1,{stddev:i=Math.sqrt(i),mean:t}},n=b(255,255,255,0,100,255),s=b(255,255,255,255,0,0);if(this.state.percentage){var o=[],i=!0,l=!1,c=void 0;try{for(var h,u=this.state.data.heatmap[Symbol.iterator]();!(i=(h=u.next()).done);i=!0){var p=h.value,d=!0,m=!1,g=void 0;try{for(var v,y=p[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var E=v.value;null!=E&&o.push(E.delta/E.startprice)}}catch(z){m=!0,g=z}finally{try{d||null==y.return||y.return()}finally{if(m)throw g}}}}catch(z){l=!0,c=z}finally{try{i||null==u.return||u.return()}finally{if(l)throw c}}var w=a(o).stddev*this.state.threshold,D=w,k=-w;t=function(e){var t=e.delta/e.startprice;return t<0?n(t/k):s(t/D)}}else{var x=a(this.state.all_values.map(function(e){return Math.log2(Math.abs(e)+1)*Math.sign(e)})).stddev*this.state.threshold,S=x,O=-x;t=function(e){return e.delta<0?n(e.delta/O):s(e.delta/S)}}var j=this.state.data.heatmap.map(function(a,n){var s=e.state.data.yLabels[n];return r.a.createElement("tr",{key:"row-"+s},r.a.createElement("td",{key:s},r.a.createElement("strong",null," ",s," ")),a.map(function(a,n){var o=e.state.data.xLabels[n];if(null==a)return r.a.createElement("td",{key:o+"-"+s});var i=a.delta,l=t(a);return e.state.percentage?r.a.createElement("td",{key:o+"-"+s,style:{backgroundColor:l}},"$",Math.round(100*a.stopprice)/100," ",r.a.createElement("small",null,"%",Math.round(a.delta/a.startprice*100))):r.a.createElement("td",{key:o+"-"+s,style:{backgroundColor:l}},"$",Math.round(100*a.stopprice)/100," ",r.a.createElement("small",null,"$",Math.round(100*i)/100))}))}),T=this.state.data.xLabels.map(function(e){return r.a.createElement("th",{key:e}," ",e," ")});return r.a.createElement("table",{className:"heatmap"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),T),j))}}]),t}(n.Component),w=a(165),D=a(163),k=a(166),x=a(35),S=a.n(x),O=a(164),j=function(){return r.a.createElement("div",{className:"container content"},r.a.createElement("center",null,r.a.createElement(O.a,null,"About")),r.a.createElement("h3",null,"Interpreting the Data"),r.a.createElement("p",null,"The ",r.a.createElement("strong",null,"x axis shows the AZ ID")," and the ",r.a.createElement("strong",null,"y axis to the left shows the instance type"),'. It is important to be aware that the AZ ID is distinct from the AZ Name. We choose to use AZ ID because, according to Amazon, the AZ ID is a "unique and consistent identifier for an availability zone" it will have the same location (corresponds to the same physical datacenter) in every account. This is not the case for the AZ Name which is a logical identifier, to ensure that resources are "distributed across the availability zones for a given region" Amazon independently maps availability zone names for each account. For these reasons we provide data in terms of the AZ ID with the hope that users will be able to apply this data to prices they see in their own accounts.'),r.a.createElement("p",null,"The values in the table are the changes in average price in dollars."),r.a.createElement("p",null,"Red colors represent an increase in price and blue colors represent a decrease in price. Some table entries are empty, these are az/insttype pairs for which no data is available. This is often the case because an instance type may not be offered in all regions."),r.a.createElement("h3",null,"Usage"),r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement("p",null,"This ",r.a.createElement("strong",null,"spot price visualizer")," is a tool for exploring both long and short term trends in the prices of instances on the ",r.a.createElement("a",{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/how-spot-instances-work.html"},"spot market")),r.a.createElement("p",null,"Usage:"),r.a.createElement("ul",null,r.a.createElement("li",null,"First, pick a start date for the range of dates you wish to examine by clicking the 'start date' date picker or by typing a value in the box"),r.a.createElement("li",null,"Second, pick a stop date by clicking the 'stop date' date picker and entering your value"),r.a.createElement("li",null,"Finally, play with the threshold slider which will determine how sensative the colorization of the data is to price change, and the 'percentage change' toggle to switch the table between showing percentage change and the raw delta in dollars.")),r.a.createElement("p",null,"The spot price visualizer will then fetch the data for the prices on the 'start' and 'stop' dates and will display a heatmap visualization of how the prices have changed between the two points in time.  It computes the average price before and after the midpoint between the two dates and reports the difference."),r.a.createElement("p",null,r.a.createElement("em",null,"Note: Our archived data goes back to 2015."))))},T=a(162),z=function(e){function t(e){var a;Object(u.a)(this,t),a=Object(d.a)(this,Object(m.a)(t).call(this,e)),console.log(a.props.location);var n,r,s,o=S.a.parse(a.props.location.search),i=!0;return o.startDate?n=new Date(o.startDate):((n=new Date).setTime(n.getTime()-12096e5),n.setHours(0)),o.stopDate?r=new Date(o.stopDate):(r=new Date).setHours(0),s=o.thresh?parseFloat(o.thresh):.5,o.percentage&&(i="true"==o.percentage),a.state={startDate:n,stopDate:r,threshold:s,percentage:i},a}return Object(g.a)(t,e),Object(p.a)(t,[{key:"changeStartDate",value:function(e){if(e){var t=Object.assign({},this.state);t.startDate=e,this.setState(t,this.updateQueryParams.bind(this))}}},{key:"changeStopDate",value:function(e){if(e){var t=Object.assign({},this.state);t.stopDate=e,this.setState(t,this.updateQueryParams.bind(this))}}},{key:"changeThreshold",value:function(e){this.chngThreshTimeout&&clearTimeout(this.chngThreshTimeout);var t=Object.assign({},this.state);t.threshold=e.target.value,this.setState(t,this.updateQueryParams.bind(this))}},{key:"updateQueryParams",value:function(){"?startDate=".concat(this.state.startDate.toISOString(),"&stopDate=").concat(this.state.stopDate.toISOString(),"&thresh=").concat(this.state.threshold,"&percentage=").concat(this.state.percentage)!==this.props.location.search&&this.props.history.push({pathname:this.props.location.pathname,search:"?startDate=".concat(this.state.startDate.toISOString(),"&stopDate=").concat(this.state.stopDate.toISOString(),"&thresh=").concat(this.state.threshold,"&percentage=").concat(this.state.percentage)})}},{key:"render",value:function(){var e=this,t=null;return null!=this.state.startDate&&null!=this.state.stopDate&&(t=r.a.createElement("center",{style:{margin:"20px"}},r.a.createElement(E,{startDate:this.state.startDate,stopDate:this.state.stopDate,threshold:this.state.threshold,percentage:this.state.percentage}))),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container content"},r.a.createElement(O.a,null,r.a.createElement("a",{href:"https://federatedcloud.org"},"Aristotle")," AWS SpotPrice Visualizer ",r.a.createElement("small",null,"(Beta Version 1.0) ")),r.a.createElement("h4",null,"For usage instructions see the ",r.a.createElement(T.a,{to:"/about"},"/about")," page"),r.a.createElement("hr",null),r.a.createElement("span",null,r.a.createElement("strong",null,"Start Date: "),r.a.createElement(i.a,{selected:this.state.startDate,onChange:this.changeStartDate.bind(this)})),r.a.createElement("span",{style:{margin:"10px"}},r.a.createElement("strong",null,"Stop Date: "),r.a.createElement(i.a,{selected:this.state.stopDate,onChange:this.changeStopDate.bind(this)})),r.a.createElement("span",{style:{margin:"10px"}},r.a.createElement("strong",null,"Threshold "),r.a.createElement("input",{type:"range",onChange:this.changeThreshold.bind(this),min:"0.05",max:"2",step:"0.05",style:{width:"100px",display:"inline"},value:this.state.threshold}),r.a.createElement("input",{type:"number",onChange:this.changeThreshold.bind(this),min:"0.05",max:"2",step:"0.05",value:this.state.threshold}),r.a.createElement("strong",null," Show % Change "),r.a.createElement("input",{type:"checkbox",onChange:function(t){var a=Object.assign({},e.state);console.log(t.target.checked),a.percentage=t.target.checked,e.setState(a,e.updateQueryParams.bind(e))},checked:this.state.percentage})),t))}}]),t}(n.Component),A=function(){return r.a.createElement(w.a,null,r.a.createElement("div",null,r.a.createElement(D.a,{exact:!0,path:"/",component:Object(k.a)(z)}),r.a.createElement(D.a,{path:"/about",component:Object(k.a)(j)})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},39:function(e,t,a){},68:function(e,t,a){e.exports=a(161)},73:function(e,t,a){},85:function(e,t,a){},94:function(e,t,a){"use strict";a.r(t),a.d(t,"getHeatMapData",function(){return c});var n=a(12),r=a.n(n),s=a(20),o=a(95),i=a(114),l=a(117)("model:spotprices");function c(e,t){return h.apply(this,arguments)}function h(){return(h=Object(s.a)(r.a.mark(function e(t,a){var n,s,c,h,u,p,d,m,g,v,f,y;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l("fetching data from the server! start date: %o, stop date: %o",t,a),e.next=3,o.get("/api/client/get_heatmap?"+i.stringify({start:t.toISOString(),stop:a.toISOString()}));case 3:if(!(n=e.sent).data.error){e.next=6;break}throw new Error(n.data.error);case 6:for(s=n.data.prices.filter(function(e){return"Linux/UNIX"===e.os}),c={},h=[],u=[],p=!0,d=!1,m=void 0,e.prev=13,g=s[Symbol.iterator]();!(p=(v=g.next()).done);p=!0)(f=v.value).key=f.zone_id+"\0"+f.insttype,c[f.key]=f,h.includes(f.zone_id)||h.push(f.zone_id),u.includes(f.insttype)||u.push(f.insttype);e.next=21;break;case 17:e.prev=17,e.t0=e.catch(13),d=!0,m=e.t0;case 21:e.prev=21,e.prev=22,p||null==g.return||g.return();case 24:if(e.prev=24,!d){e.next=27;break}throw m;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return h.sort(),u.sort(),y=u.map(function(e){return h.map(function(t){var a=c[t+"\0"+e];return a?(l("%o %o -- delta: %o",a.zone_id,a.insttype,a.delta),a):(l("%o %o -- no datapoint",t,e),null)})}),l("constructed heatmap %o",y),e.abrupt("return",{xLabels:h,yLabels:u,heatmap:y,lookup:c});case 34:case"end":return e.stop()}},e,this,[[13,17,21,29],[22,,24,28]])}))).apply(this,arguments)}}},[[68,2,1]]]);
//# sourceMappingURL=main.e0bfc8d8.chunk.js.map