(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(93)},39:function(e,t,a){},41:function(e,t,a){},53:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t),a.d(t,"getHeatMapData",function(){return c});var n=a(8),r=a.n(n),s=a(14),l=a(63),i=a(82),o=a(85)("model:spotprices");function c(e,t){return h.apply(this,arguments)}function h(){return(h=Object(s.a)(r.a.mark(function e(t,a){var n,s,c,h,u,p,d,m,f,v,g,y;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o("fetching data from the server! start date: %o, stop date: %o",t,a),e.next=3,l.get("/api/client/get_heatmap?"+i.stringify({start:t.toISOString(),stop:a.toISOString()}));case 3:if(!(n=e.sent).data.error){e.next=6;break}throw new Error(n.data.error);case 6:for(s=n.data.prices.filter(function(e){return"Linux/UNIX"===e.os}),c={},h=[],u=[],p=!0,d=!1,m=void 0,e.prev=13,f=s[Symbol.iterator]();!(p=(v=f.next()).done);p=!0)(g=v.value).key=g.az+"\0"+g.insttype,c[g.key]=g,h.includes(g.az)||h.push(g.az),u.includes(g.insttype)||u.push(g.insttype);e.next=21;break;case 17:e.prev=17,e.t0=e.catch(13),d=!0,m=e.t0;case 21:e.prev=21,e.prev=22,p||null==f.return||f.return();case 24:if(e.prev=24,!d){e.next=27;break}throw m;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return h.sort(),u.sort(),y=new Array(u.length).fill(0).map(function(e,t){return new Array(h.length).fill(0).map(function(e,a){var n=u[t],r=h[a],s=c[r+"\0"+n];return s?(o("%o %o -- delta: %o",s.az,s.insttype,s.delta),s.delta):(o("%o %o -- no datapoint",r,n),null)})}),o("constructed heatmap %o",y),e.abrupt("return",{xLabels:h,yLabels:u,heatmap:y});case 34:case"end":return e.stop()}},e,this,[[13,17,21,29],[22,,24,28]])}))).apply(this,arguments)}},93:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(10),l=a.n(s),i=(a(39),a(11)),o=a(12),c=a(15),h=a(13),u=a(16),p=(a(41),a(20)),d=(a(49),a(8)),m=a.n(d),f=a(14),v=(a(53),a(33)),g=a.n(v),y=a(62).getHeatMapData,b=function(e,t,a,n,r,s){return function(l){var i=1-l,o=l;return"rgb(".concat(Math.round(i*e+o*n),", ").concat(Math.round(i*t+o*r),", ").concat(Math.round(i*a+o*s),")")}},w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(h.a)(t).call(this,e))).state={loading:!0,data:null,percentileThreshold:e.percentileThreshold},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.startDate!==this.state.startDate||this.props.stopDate!==this.state.stopDate||this.props.percentileThreshold!==this.state.percentileThreshold){this.setState({loading:!0,data:null,startDate:this.props.startDate,stopDate:this.props.stopDate,percentileThreshold:this.props.percentileThreshold});var t=this.props;Object(f.a)(m.a.mark(function a(){var n;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,y(t.startDate,t.stopDate);case 2:n=a.sent,e.setState({loading:!1,data:n});case 4:case"end":return a.stop()}},a,this)}))()}}},{key:"updateColorThresholds",value:function(){var e=[],t=this.state.data.heatmap,a=!0,n=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var i=s.value,o=!0,c=!1,h=void 0;try{for(var u,p=i[Symbol.iterator]();!(o=(u=p.next()).done);o=!0){var d=u.value;e.push(d)}}catch(w){c=!0,h=w}finally{try{o||null==p.return||p.return()}finally{if(c)throw h}}}}catch(w){n=!0,r=w}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}var m=-1,f=1,v=e.filter(function(e){return e<0}),g=e.filter(function(e){return e>0}),y=Math.min(Math.max(this.state.percentileThreshold/100,0),1);g.length>0&&(g.sort(),f=g[Math.floor(g.length*(1-y))]),v.length>0&&(v.sort(),m=e[Math.floor(v.length*y)]);var b=Math.max(f,-m);this.pUpper=b,this.pLower=-b}},{key:"render",value:function(){var e=this;if(this.state.loading)return r.a.createElement(g.a,{loading:!0,color:"#415EFF"});this.updateColorThresholds();var t=this.pUpper,a=this.pLower,n=this.state.data.heatmap.map(function(n,s){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("strong",null,e.state.data.yLabels[s])),n.map(function(e){var n;return n=e<0?b(255,255,255,0,0,255)(e/a):b(255,255,255,255,0,0)(e/t),null==e?r.a.createElement("td",null):r.a.createElement("td",{style:{backgroundColor:n}},"$",Math.round(1e3*e)/1e3)}))}),s=this.state.data.xLabels.map(function(e){return r.a.createElement("th",{key:"header:"+e},e)});return r.a.createElement("table",{className:"heatmap"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),s),n))}}]),t}(n.Component),E=function(e){function t(e){var a;Object(i.a)(this,t),a=Object(c.a)(this,Object(h.a)(t).call(this,e));var n=new Date,r=new Date;return n.setDate(r.getDate()-365),a.state={startDate:null,stopDate:null,percentileThreshold:8},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"changeStartDate",value:function(e){if(e){var t=Object.assign({},this.state);t.startDate=e,this.setState(t)}}},{key:"changeStopDate",value:function(e){if(e){var t=Object.assign({},this.state);t.stopDate=e,this.setState(t)}}},{key:"changePercentileThreshold",value:function(e){var t=Object.assign({},this.state);t.percentileThreshold=e.target.value,this.setState(t)}},{key:"render",value:function(){var e=null;null!=this.state.startDate&&null!=this.state.stopDate&&(e=r.a.createElement("center",{style:{margin:"20px"}},r.a.createElement(w,{startDate:this.state.startDate,stopDate:this.state.stopDate,percentileThreshold:this.state.percentileThreshold})));var t=r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement("p",null,"This ",r.a.createElement("strong",null,"spot price visualizer")," is a tool for exploring both long and short term trends in the prices of instances on the ",r.a.createElement("a",{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/how-spot-instances-work.html"},"spot market")),r.a.createElement("p",null,"Usage:"),r.a.createElement("ul",null,r.a.createElement("li",null,"First, pick a start date for the range of dates you wish to examine by clicking the 'start date' date picker or by typing a value in the box"),r.a.createElement("li",null,"Second, pick a stop date by clicking the 'stop date' date picker and entering your value"),r.a.createElement("li",null,"Third, for advanced users, enter the percentile threshold which will be used to determine colors. Leave this as default if you don't know what this means.")),r.a.createElement("p",null,"The spot price visualizer will then fetch the data for the prices on the 'start' and 'stop' dates and will display a heatmap visualization of how the prices have changed between the two points in time. The x axis at the top shows the az name and the y axis to the left shows the instance type. The values in the table are the changes in price in dollars. Red colors represent an increase in price and blue colors represent a decrease in price. Some table entries are empty, these are az/insttype pairs for which no data is available as that instance type may not be offered in all regions."),r.a.createElement("p",null,"Note: Our archived data goes back to 2015."),r.a.createElement("p",null,"This project is made by Gareth George at UC Santa Barbara\u2019s ",r.a.createElement("a",{href:"http://www.cs.ucsb.edu/~ckrintz/racelab.html"},"RACELab")));return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"content"},r.a.createElement("h1",null,"AWS SpotPrice Visualizer"),r.a.createElement("span",null,r.a.createElement("strong",null,"Start Date: "),r.a.createElement(p.a,{selected:this.state.startDate,onChange:this.changeStartDate.bind(this)})),r.a.createElement("span",{style:{margin:"10px"}},r.a.createElement("strong",null,"Stop Date: "),r.a.createElement(p.a,{selected:this.state.stopDate,onChange:this.changeStopDate.bind(this)})),r.a.createElement("span",{style:{margin:"10px"}},r.a.createElement("strong",null,"Percentile Threshold"),r.a.createElement("input",{type:"number",onChange:this.changePercentileThreshold.bind(this),min:"0",max:"100",step:"1",value:this.state.percentileThreshold})),e,r.a.createElement("hr",null),t))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,2,1]]]);
//# sourceMappingURL=main.481ab3bb.chunk.js.map